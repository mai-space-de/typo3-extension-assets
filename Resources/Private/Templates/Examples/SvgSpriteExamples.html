<html
    xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
    data-namespace-typo3-fluid="true"
>
<!--
    Example Template: SvgSpriteExamples.html
    ==========================================
    Demonstrates every argument and usage pattern of <ma:svgSprite>.

    The global "ma" namespace is pre-registered — no {namespace} declaration needed.

    HOW IT WORKS
    ------------
    Icons are registered declaratively in each extension's SpriteIcons.php:

      // EXT:my_sitepackage/Configuration/SpriteIcons.php
      return [
          'icon-arrow'   => ['src' => 'EXT:my_sitepackage/Resources/Public/Icons/arrow.svg'],
          'icon-close'   => ['src' => 'EXT:my_sitepackage/Resources/Public/Icons/close.svg'],
          'icon-search'  => ['src' => 'EXT:my_sitepackage/Resources/Public/Icons/search.svg'],
          'icon-warning' => ['src' => 'EXT:my_sitepackage/Resources/Public/Icons/warning.svg'],
      ];

    The SpriteIconRegistry auto-discovers every loaded extension's SpriteIcons.php and
    assembles all symbols into a single SVG sprite served from the HTTP endpoint
    (default: /maispace/sprite.svg).

    In your Fluid templates, simply reference a symbol ID with <ma:svgSprite use="...">.
    The ViewHelper outputs an <svg><use href="/maispace/sprite.svg#id"></use></svg> element.
    No register or render calls are needed in templates.

    ARGUMENT REFERENCE
    ------------------
    use         string  Required. Symbol ID to reference (must exist in a SpriteIcons.php).
    src         string  Override the sprite URL (for multi-sprite setups).
    class       string  class attribute on the <svg> element.
    width       string  width attribute on the <svg> element.
    height      string  height attribute on the <svg> element.
    aria-hidden string  Defaults to "true" for decorative icons.
    aria-label  string  Set for meaningful icons — adds role="img" automatically.
    title       string  <title> inside <svg> for additional screen reader context.
-->


<!-- =========================================================================
     PART 1: BASIC USAGE
     =========================================================================
     The simplest call — symbol ID is all that is required.
     aria-hidden="true" is added automatically for decorative icons.
-->

<!-- 1a. Decorative icon (no accessible label needed, text provides the context) -->
<a href="/search" class="search-link">
    <ma:svgSprite use="icon-search" width="18" height="18" class="icon" />
    Search
</a>

<!-- 1b. Decorative icon in a button (aria-label on the button, not the icon) -->
<button class="btn btn--icon" type="button" aria-label="Go to next slide">
    <ma:svgSprite use="icon-arrow" width="20" height="20" class="icon" />
</button>

<!-- 1c. Icon without explicit dimensions — size set via CSS -->
<span class="icon-wrapper">
    <ma:svgSprite use="icon-search" class="icon icon--search icon--sm" />
</span>


<!-- =========================================================================
     PART 2: ACCESSIBLE ICONS
     =========================================================================
     When an icon carries meaning on its own (no adjacent text), use aria-label
     or title to make it accessible to screen readers.
-->

<!-- 2a. Meaningful icon — aria-label provided, role="img" added automatically,
         aria-hidden is omitted -->
<a href="https://twitter.com/example" rel="noopener noreferrer">
    <ma:svgSprite
        use="icon-twitter"
        width="24"
        height="24"
        class="icon icon--social"
        aria-label="Follow us on Twitter"
    />
</a>

<!-- 2b. Icon with <title> instead of aria-label — alternative accessible approach -->
<a href="https://linkedin.com/company/example" rel="noopener noreferrer">
    <ma:svgSprite
        use="icon-linkedin"
        width="24"
        height="24"
        class="icon icon--social"
        title="Visit our LinkedIn page"
    />
</a>

<!-- 2c. Icon-only button — aria-label on the <svg> itself -->
<button class="btn btn--icon-only" type="button">
    <ma:svgSprite
        use="icon-close"
        width="24"
        height="24"
        class="icon"
        aria-label="Close dialog"
    />
</button>

<!-- 2d. Inline status icon with aria-hidden="false" — explicit override -->
<span class="status-indicator status-indicator--error">
    <ma:svgSprite
        use="icon-warning"
        width="16"
        height="16"
        aria-hidden="false"
        aria-label="Error"
    />
    Form submission failed
</span>


<!-- =========================================================================
     PART 3: ICONS IN DYNAMIC CONTEXTS
     =========================================================================
     Icons used in loops and conditional rendering — the SpriteIcons.php registry
     is static, so all symbols are always available regardless of template context.
-->

<!-- 3a. Navigation with per-item icons registered in SpriteIcons.php -->
<nav class="main-nav" aria-label="Main navigation">
    <f:for each="{navigationItems}" as="item">
        <a href="{item.link}" class="nav-item {f:if(condition: item.active, then: 'nav-item--active')}">
            <f:if condition="{item.iconId}">
                <ma:svgSprite
                    use="{item.iconId}"
                    width="20"
                    height="20"
                    class="nav-item__icon"
                    aria-hidden="true"
                />
            </f:if>
            <span>{item.title}</span>
        </a>
    </f:for>
</nav>

<!-- 3b. Conditional icon — only rendered when the condition is true,
         but the symbol is always available in the sprite (no lazy-loading needed) -->
<f:if condition="{settings.showSearch}">
    <a href="/search" class="btn btn--ghost btn--icon" aria-label="Search">
        <ma:svgSprite use="icon-search" width="20" height="20" aria-hidden="true" />
    </a>
</f:if>


<!-- =========================================================================
     PART 4: MULTI-SPRITE SETUP
     =========================================================================
     For large projects with distinct icon sets (e.g., a brand sprite served
     from a CDN), override the sprite URL per icon with the src argument.
     The default sprite URL (/maispace/sprite.svg) is used for all other icons.
-->

<!-- 4a. Icon from the default extension sprite -->
<ma:svgSprite use="icon-arrow" width="16" height="16" />

<!-- 4b. Icon from an alternative / CDN-hosted sprite -->
<ma:svgSprite
    use="icon-brand-logo"
    src="/brand/sprite.svg"
    width="120"
    height="40"
    aria-label="Brand"
/>


<!-- =========================================================================
     PART 5: COMPLETE REALISTIC EXAMPLE — Card component
     =========================================================================
     A realistic content element partial.
     Icons used here must be declared in a SpriteIcons.php file somewhere
     across the loaded extensions — no register call in the template needed.
-->

<article class="card" aria-labelledby="card-{record.uid}-title">
    <f:if condition="{record.image}">
        <div class="card__media">
            <f:image image="{record.image}" />
        </div>
    </f:if>

    <div class="card__body">
        <f:if condition="{record.category}">
            <span class="card__category">{record.category.title}</span>
        </f:if>

        <h3 class="card__title" id="card-{record.uid}-title">
            {record.title}
        </h3>

        <f:if condition="{record.teaser}">
            <p class="card__teaser">{record.teaser}</p>
        </f:if>

        <a href="{record.link}" class="card__cta">
            <f:if condition="{record.isExternal}">
                <f:then>
                    Read more
                    <ma:svgSprite
                        use="icon-external-link"
                        width="14"
                        height="14"
                        class="icon icon--inline"
                        aria-label="(opens in new window)"
                    />
                </f:then>
                <f:else>
                    Read more
                    <ma:svgSprite
                        use="icon-arrow"
                        width="16"
                        height="16"
                        class="icon icon--inline"
                        aria-hidden="true"
                    />
                </f:else>
            </f:if>
        </a>
    </div>
</article>


<!-- =========================================================================
     PART 6: SPRITE ENDPOINT AND CACHING BEHAVIOUR
     =========================================================================
     The sprite is served from a PSR-15 middleware endpoint.

     Default URL:   /maispace/sprite.svg
     Configurable:  plugin.tx_maispace_assets.svgSprite.routePath = /assets/icons.svg

     HTTP response headers:
       Content-Type:  image/svg+xml; charset=utf-8
       Cache-Control: public, max-age=31536000, immutable
       ETag:          "<sha1-of-sprite-xml>"
       Vary:          Accept-Encoding

     Cache behaviour:
       - The ETag is derived from a SHA-1 of the assembled sprite XML.
       - Browsers cache the sprite for one year (immutable).
       - On repeat visits the browser sends If-None-Match; the middleware returns
         304 Not Modified if the sprite has not changed (zero body transfer).
       - The server-side cache key includes every symbol's ID, absolute source path,
         and filemtime — any SVG file change produces a new cache entry automatically.
       - The cache belongs to groups "pages" and "all", so it is cleared whenever
         the TYPO3 frontend cache is flushed.

     Disable server-side caching during development:
       plugin.tx_maispace_assets.svgSprite.cache = 0
-->

</html>
