services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: false

    Maispace\MaispaceAssets\:
        resource: '../Classes/*'

    # -------------------------------------------------------------------------
    # Public services
    #
    # These services must be public so GeneralUtility::makeInstance() (used inside
    # static ViewHelper renderStatic() methods) can resolve them from the DI container.
    # -------------------------------------------------------------------------

    Maispace\MaispaceAssets\Cache\AssetCacheManager:
        public: true

    Maispace\MaispaceAssets\Service\AssetProcessingService:
        public: true

    Maispace\MaispaceAssets\Service\ScssCompilerService:
        public: true

    # SpriteIconRegistry implements SingletonInterface.
    # The DI container respects SingletonInterface and returns the same instance
    # throughout the request when resolved via GeneralUtility::makeInstance().
    # Must be public so SvgSpriteMiddleware (resolved via DI) and SvgSpriteViewHelper
    # (resolved via GeneralUtility::makeInstance in static renderStatic) both get
    # the identical singleton with the already-built sprite.
    Maispace\MaispaceAssets\Registry\SpriteIconRegistry:
        public: true

    # FontRegistry implements SingletonInterface — same reasoning as SpriteIconRegistry.
    # Must be public so FontPreloadEventListener (DI-resolved) always gets the same
    # singleton instance that has already performed auto-discovery.
    Maispace\MaispaceAssets\Registry\FontRegistry:
        public: true

    # ImageRenderingService must be public so the ViewHelpers (which use static
    # renderStatic() and resolve dependencies via GeneralUtility::makeInstance())
    # receive the DI-configured instance with ImageService and LoggerInterface injected.
    Maispace\MaispaceAssets\Service\ImageRenderingService:
        public: true

    # FontPreloadEventListener — registered as a real event listener (not an example).
    # Font preloading is a core feature of maispace_assets, not an opt-in hook.
    Maispace\MaispaceAssets\EventListener\FontPreloadEventListener:
        tags:
            -   name: event.listener
                identifier: 'maispace-assets-font-preload'
                event: TYPO3\CMS\Core\Page\Event\BeforeStylesheetsRenderingEvent

    # -------------------------------------------------------------------------
    # Example event listeners
    #
    # These listeners are intentionally commented out. They ship as working
    # examples to demonstrate how to hook into the maispace_assets event system.
    #
    # To activate a listener, copy the relevant block into your site package's
    # Configuration/Services.yaml and uncomment it there. Do NOT uncomment here,
    # as that would activate the example for every project using this extension.
    #
    # Available events:
    #   - Maispace\MaispaceAssets\Event\AfterCssProcessedEvent
    #   - Maispace\MaispaceAssets\Event\AfterJsProcessedEvent
    #   - Maispace\MaispaceAssets\Event\AfterScssCompiledEvent
    #   - Maispace\MaispaceAssets\Event\BeforeSpriteSymbolRegisteredEvent
    #   - Maispace\MaispaceAssets\Event\AfterSpriteBuiltEvent
    #   - Maispace\MaispaceAssets\Event\BeforeImageProcessingEvent
    #   - Maispace\MaispaceAssets\Event\AfterImageProcessedEvent
    # -------------------------------------------------------------------------

    # Maispace\MaispaceAssets\EventListener\AfterCssProcessedEventListener:
    #     tags:
    #         -   name: event.listener
    #             identifier: 'maispace-assets-example-css'
    #             event: Maispace\MaispaceAssets\Event\AfterCssProcessedEvent

    # Maispace\MaispaceAssets\EventListener\AfterJsProcessedEventListener:
    #     tags:
    #         -   name: event.listener
    #             identifier: 'maispace-assets-example-js'
    #             event: Maispace\MaispaceAssets\Event\AfterJsProcessedEvent

    # Maispace\MaispaceAssets\EventListener\AfterScssCompiledEventListener:
    #     tags:
    #         -   name: event.listener
    #             identifier: 'maispace-assets-example-scss'
    #             event: Maispace\MaispaceAssets\Event\AfterScssCompiledEvent

    # Maispace\MaispaceAssets\EventListener\BeforeSpriteSymbolRegisteredEventListener:
    #     tags:
    #         -   name: event.listener
    #             identifier: 'maispace-assets-example-before-sprite-symbol'
    #             event: Maispace\MaispaceAssets\Event\BeforeSpriteSymbolRegisteredEvent

    # Maispace\MaispaceAssets\EventListener\AfterSpriteBuiltEventListener:
    #     tags:
    #         -   name: event.listener
    #             identifier: 'maispace-assets-example-after-sprite-built'
    #             event: Maispace\MaispaceAssets\Event\AfterSpriteBuiltEvent

    # Maispace\MaispaceAssets\EventListener\BeforeImageProcessingEventListener:
    #     tags:
    #         -   name: event.listener
    #             identifier: 'maispace-assets-example-before-image-processing'
    #             event: Maispace\MaispaceAssets\Event\BeforeImageProcessingEvent

    # Maispace\MaispaceAssets\EventListener\AfterImageProcessedEventListener:
    #     tags:
    #         -   name: event.listener
    #             identifier: 'maispace-assets-example-after-image-processed'
    #             event: Maispace\MaispaceAssets\Event\AfterImageProcessedEvent
